> [Wiki](Home) ▸ [[API--中文手册]] ▸ [[比例尺]] ▸ **序数比例尺**

* 本文档是D3官方文档中文翻译，并保持与[最新版](https://github.com/mbostock/d3/wiki/API-Reference)同步。
* 如发现翻译不当或有其他问题可以通过以下方式联系译者:
* 邮箱：zhang_tianxu@sina.com
* QQ群：[D3数据可视化](http://jq.qq.com/?_wv=1027&k=ZGcqYF)205076374，[大数据可视化](http://jq.qq.com/?_wv=1027&k=S8wGMe)436442115

例尺是一个函数，用来映射输入域到输出范围。序数比例尺有一个离散域，诸如一组名称或类别。也有定量比例尺，其具有连续的输入域，如实数集。比例尺在D3中是一个可选的功能，如果你喜欢自己处理数学的话大可不必使用它们。然而使用比例尺可以大大简化映射数据到可视化编码的必需代码量。
一个比例尺对象，例如d3.scale.ordinal的返回值既是一个对象也是一个函数。这样，你就可以像函数一样使用比例尺。并且比例尺有附加的方法可以改变它的行为。像D3中的其他类，比例尺遵循链式语法setter方法直接返回比例尺自己，允许多个setter方法在一个简洁的语句中调用。
# d3.scale.ordinal()
构造一个新的序数比例尺，使用空的域和范围。序数比例尺没有指定输出范围之后是无效的（总是返回undefined）。
# ordinal(x)
给定输入域中的一个值x，返回输出返回中对应的值。如果范围被明确地指定（通过range而不是rangeBands、rangeRoundBands或者rangePoints），并且给定的值x不在比例尺的域中，然后x就会被隐含地添加进域中；随后，当使用相同的值x调用比例尺时就会返回范围中相同的值y。
# ordinal.domain([values])
如果指定了参数values，就会设置序数比例尺的输入域为指定的values数组。Values中的第一个元素会映射为输出范围中的第一个值，第二个元素会映射为输出范围中的第二个值，等等。域数组values在在内部存储到一个关联数组中作为从值到索引的映射；产生的索引随后被用来从输出范围中取值。这样，序数比例尺的值就必须强制转换为字符串，并且域值字符串化版本唯一地标识对应的范围值。如果没有指定values，这个方法就会返回当前的域。
设置序数比例尺中的域是可选的。如果没有设置域，必须明确地指定范围。然后，每个传给比例尺函数的唯一的值都将被指定一个输入范围中的新值；换句话说，域必须要能从使用情况中推断出来。虽然域可能被隐式构造，最好还是显式指定序数比例尺的域，以保证确定性的行为，从使用情况推断域名将取决于顺序。
# ordinal.range([values])
如果指定了参数values，就会设置序数比例尺的输出范围为指定的values数组。域中的第一个元素会映射为输出范围values中的第一个值，第二个元素会映射为输出范围values中的第二个值，等等。如果输出范围中的值少于域，比例尺就会再次从范围的开始处循环取值。如果没有指定values，这个方法就会返回当前的输出范围。

此方法适用于当一组离散的输出值被明确地计算，例如一组明确的颜色。在其他情况下，如确定一个序数散点图或条形图的布局，你可能会发现rangePoints或rangeBands操作符更方便。
# ordinal.rangePoints(interval[, padding])
 
d3.scale.ordinal().domain([1, 2, 3, 4]).rangePoints([0, 100], 0).range();
// returns [0, 33.333333333333336, 66.66666666666667, 100]
# ordinal.rangeBands(interval[, padding[, outerPadding]])
从指定的持续interval设置输出范围。interval数组包含两个代表最大值最小值的数值元素。此区间被细分成n个均匀间距频段，其中n是输入域（唯一的）值的数量。这个频段可能从区间的边缘和其他的频段偏移了，根据指定的填充padding（默认为0）。Padding通常在范围[0,1]之内，对应范围区间中划分给填充的空间总数。值0.5意思是频段的宽度和间隔的宽度相同。参数outerPadding用于整个频段组。0值意味着只在rangeBands之间进行填充。
 
var o = d3.scale.ordinal().domain([1, 2, 3, 4]).rangeBands([0, 100]);
o.rangeBand(); // returns 25
o.range(); // returns [0, 25, 50, 75]
o.rangeExtent(); // returns [0, 100]
# ordinal.rangeRoundBands(interval[, padding[, outerPadding]])
类似于rangeBands，除了保证频段宽度和偏移量是整数，以免平滑处理工件。
牢记组分必须四舍五入，每个组分都要分配在频段开始和结束之间作为outerPadding之上额外的填充。错误的填充正比于域长度；平均添加到大约domain.length / 2长。在这个例子中，被细分为3条，但长约为长度100的域的50。在域是未知或可能无界的情况下，使用rangeBands利用CSS的shape-rendering: crispEdges是可取的。
# ordinal.rangeBand()
返回频段宽度。当比例尺的频段使用rangeBands或者rangeRoundBands设置时，比例尺返回给定输入的较小值。较大值随后通过频段宽度偏移计算。如果比例尺的范围使用range或者rangePoints设置，频段宽度是0。
# ordinal.rangeExtent()
返回两元素的数组代表比例尺的范围，例如最大值和最小值。
# ordinal.copy()
返回这个序数比例尺精确的副本。变为这个比例尺将不会影响返回的比例尺，反之亦然。
Categorical Colors
# d3.scale.category10()
构造一个新的序数比例尺，使用10种类型的颜色：
  #1f77b4
  #ff7f0e
  #2ca02c
  #d62728
  #9467bd
  #8c564b
  #e377c2
  #7f7f7f
  #bcbd22
  #17becf
# d3.scale.category20()
构造一个新的序数比例尺，使用20种类型的颜色：

  #1f77b4
  #aec7e8
  #ff7f0e
  #ffbb78
  #2ca02c
  #98df8a
  #d62728
  #ff9896
  #9467bd
  #c5b0d5
  #8c564b
  #c49c94
  #e377c2
  #f7b6d2
  #7f7f7f
  #c7c7c7
  #bcbd22
  #dbdb8d
  #17becf
  #9edae5
# d3.scale.category20b()
构造一个新的序数比例尺，使用20种类型的颜色：

  #393b79
  #5254a3
  #6b6ecf
  #9c9ede
  #637939
  #8ca252
  #b5cf6b
  #cedb9c
  #8c6d31
  #bd9e39
  #e7ba52
  #e7cb94
  #843c39
  #ad494a
  #d6616b
  #e7969c
  #7b4173
  #a55194
  #ce6dbd
  #de9ed6
# d3.scale.category20c()
构造一个新的序数比例尺，使用20种类型的颜色：

  #3182bd
  #6baed6
  #9ecae1
  #c6dbef
  #e6550d
  #fd8d3c
  #fdae6b
  #fdd0a2
  #31a354
  #74c476
  #a1d99b
  #c7e9c0
  #756bb1
  #9e9ac8
  #bcbddc
  #dadaeb
  #636363
  #969696
  #bdbdbd
  #d9d9d9
ColorBrewer
D3也通过Cynthia Brewer绑定了一些奇妙的分类颜色尺。你可以从lib/colorbrewer找到这些颜色尺的CSS和Javascript。
对于CSS，给你想填充的元素指定一个像"q0-3"、"q1-3"或"q2-3"这样的类。然后，在父元素（例如SVG元素）上设置类属性，使用所需的颜色尺名称，例如"RdBu"或"Blues"。例见：calendar heatmap,choropleth http://mbostock.github.com/d3/talk/20111116/calendar.html
对于JavaScript，你可以使用colorbrewer.RdBu[9]或者等价的方法作为一个d3.scale.ordinal的范围。例如：
var z = d3.scale.ordinal()
    .domain(["foo", "bar", "baz"])
    .range(colorbrewer.RdBu[9]);

Gulu 翻译 2014-11-24 23:21:05

